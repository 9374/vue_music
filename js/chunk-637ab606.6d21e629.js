(window["webpackJsonp_music_pc2"]=window["webpackJsonp_music_pc2"]||[]).push([["chunk-637ab606"],{"0a35":function(e,t,s){"use strict";s("d533")},"34e3":function(e,t,s){},"5dd1":function(e,t,s){"use strict";s("cfb3")},bebc:function(e,t,s){},c1f7:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{"font-size":"14px"}},[t("header",{staticClass:"head"},[t("Header")],1),t("div",{staticClass:"main"},[t("aside",[t("Aside")],1),t("main",[t("AppMain")],1)]),t("footer",[t("Footer")],1)])},a=[],r=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{height:"100%"}},[t("el-menu",{attrs:{"default-openeds":["1","3"],router:"","active-text-color":"#ec4141"}},[t("el-menu-item",{attrs:{index:"/home"}},[t("i",{staticClass:"el-icon-menu"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v("发现音乐")])]),t("el-submenu",{attrs:{index:"2",disabled:!e.isLogin}},[t("template",{slot:"title"},[t("i",{staticClass:"el-icon-s-custom"}),e._v("创建的歌单")]),t("el-menu-item-group",e._l(e.userCreatePlayList,(function(s){return t("el-menu-item",{key:s.id,staticClass:"menuSongList",attrs:{index:"/home/songsList/"+s.id}},[e._v(e._s(s.name))])})),1)],2),t("el-submenu",{attrs:{index:"3",disabled:!e.isLogin}},[t("template",{slot:"title"},[t("i",{staticClass:"el-icon-star-on"}),e._v("收藏的歌单")]),t("el-menu-item-group",e._l(e.userCollectionPlayList,(function(s){return t("el-menu-item",{key:s.id,staticStyle:{padding:"0 20px"},attrs:{index:"/home/songsList/"+s.id}},[e._v(e._s(s.name))])})),1)],2)],1)],1)},o=[],n=(s("0643"),s("2382"),s("2f62")),l=s("f17b"),c={data(){return{userPlayList:{playlist:[]}}},watch:{isLogin(e){e?this.initUserPlayList():this.userPlayList={}},userInfo(e){e?this.initUserPlayList():this.userPlayList={}}},methods:{async initUserPlayList(){if(this.isLogin){const e=await Object(l["k"])(this.userInfo.userId);200===e.status&&(this.userPlayList=e.data)}}},computed:{...Object(n["c"])("user",["isLogin"]),...Object(n["e"])("user",["userInfo"]),userCreatePlayList(){return this.userPlayList.playlist?this.userPlayList.playlist.filter(e=>!1===e.subscribed):[]},userCollectionPlayList(){return this.userPlayList.playlist?this.userPlayList.playlist.filter(e=>!0===e.subscribed):[""]}},created(){this.initUserPlayList()}},d=c,u=(s("5dd1"),s("2877")),m=Object(u["a"])(d,r,o,!1,null,"782145b7",null),p=m.exports,h=function(){var e=this,t=e._self._c;return t("el-row",[t("el-col",{attrs:{span:20}},[t("div",{staticClass:"song"},[t("Play")],1)]),t("el-col",{attrs:{span:4}},[t("div",{staticClass:"menu"},[t("i",{class:e.isLoop?"el-icon-refresh":"el-icon-refresh-right",staticStyle:{"margin-right":"5px"},on:{click:function(t){return e.changeLoop()}}}),t("i",{staticClass:"el-icon-s-fold",on:{click:function(t){e.drawer=!e.drawer}}})])]),t("el-drawer",{attrs:{withHeader:!1,"show-close":!1,size:"30%",modal:!1,"append-to-body":!0,visible:e.drawer,direction:e.direction,"before-close":e.handleClose},on:{"update:visible":function(t){e.drawer=t}}},[t("el-card",{staticClass:"box-card",scopedSlots:e._u([{key:"header",fn:function(){return[t("h3",[e._v("正在播放")]),t("div",{staticClass:"info",staticStyle:{display:"flex"}},[t("div",[t("span",{staticStyle:{clolor:"#ccc"}},[e._v("共"+e._s(e.playList.length)+"首")])]),t("div",{staticClass:"btn"},[t("el-button",{attrs:{type:"primary",round:"",disabled:""}},[t("i",{staticClass:"el-icon-folder-add"}),e._v(" 收藏全部")]),t("el-button",{attrs:{type:"info",round:""},on:{click:function(t){return e.clearPlayList()}}},[e._v("清空列表")])],1)])]},proxy:!0}])},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"}),t("SongsTable",{attrs:{SongsList:e.playList,status:"list",btn:!1}})],1)],1)],1)},f=[],g=s("42e6"),v=s("6f29"),b={components:{Play:v["default"],SongsTable:g["a"]},data(){return{drawer:!1,direction:"rtl"}},methods:{...Object(n["d"])("play",["changePlayId","clearPlayList","changeLoopState"]),handleClose(e){e()},changeLoop(){this.changeLoopState(!this.isLoop),this.$message({message:this.isLoop?"切换为单曲循环":"切换为列表循环",type:"success"})}},computed:{...Object(n["e"])("play",["playList","isLoop"])},name:"Footer"},y=b,w=(s("0a35"),Object(u["a"])(y,h,f,!1,null,"74d64413",null)),_=w.exports,L=(s("14d9"),function(){var e=this,t=e._self._c;return t("div",[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12,offset:0}},[t("el-input",{directives:[{name:"popover",rawName:"v-popover:popover",arg:"popover"}],style:{width:"200px",borderRadius:"30px"},attrs:{size:"small",placeholder:"搜索音乐"},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}})],1),t("el-col",{staticStyle:{height:"60px"},attrs:{span:6,offset:0}}),t("el-col",{staticClass:"user",attrs:{span:6,offset:0}},[t("div",{staticClass:"user_avatar"},[t("el-avatar",{directives:[{name:"show",rawName:"v-show",value:!e.isLogin,expression:"!isLogin"}],attrs:{icon:"el-icon-user-solid"},nativeOn:{click:function(t){e.dialogFormVisible=!0}}}),t("el-avatar",{directives:[{name:"show",rawName:"v-show",value:e.isLogin,expression:"isLogin"}],attrs:{src:e.userInfo.avatarUrl?e.userInfo.avatarUrl+"?param=50y50":"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png"}})],1),t("div",{staticClass:"user_info"},[t("p",{directives:[{name:"show",rawName:"v-show",value:!e.isLogin,expression:"!isLogin"}],staticStyle:{color:"#fff","font-size":"14px"},on:{click:function(t){e.dialogFormVisible=!0,e.activeName="email"}}},[e._v(" 未登录 ")]),t("p",{directives:[{name:"show",rawName:"v-show",value:e.isLogin,expression:"isLogin"},{name:"popover",rawName:"v-popover:popoverUser",arg:"popoverUser"}]},[e._v(" "+e._s(e.userInfo.nickname)+" ")])])])],1),t("el-popover",{ref:"popover",attrs:{placement:"bottom-start",width:"280",title:0===e.searchlist.length?"热门搜索":"",trigger:"focus"}},[t("div",[0===e.searchlist.length?t("div",{staticClass:"hot_search"},[t("ul",{staticClass:"hot_name_wrap"},e._l(e.hotList,(function(s){return t("li",{key:s.first,staticClass:"hot_item",on:{click:function(t){return e.addhot(s.first)}}},[e._v(" "+e._s(s.first)+" ")])})),0)]):t("div",{staticClass:"hot_search"},[t("div",{staticClass:"btn"},[t("el-button",{attrs:{type:"info",size:"mini",round:""},on:{click:e.delResult}},[e._v("清空搜索列表")]),t("el-button",{attrs:{type:"primary",size:"mini",round:""},on:{click:function(t){return e.$router.push("/home/searchList/"+e.input)}}},[e._v("详细列表 ")])],1),t("p",{staticClass:"hot_title"},[e._v("搜索结果")]),e._l(e.searchlist,(function(e){return t("div",{key:e.id},[t("el-divider"),t("SongItem",{attrs:{songName:e.name,author:e.artists[0].name,album:e.album.name,id:e.id}})],1)}))],2)])]),t("el-dialog",{attrs:{width:"300px","append-to-body":!0,title:"登录",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"手机帐号",name:"phone"}}),t("el-tab-pane",{attrs:{label:"邮箱帐号",name:"email"}}),t("el-tab-pane",{attrs:{label:"二维码",name:"Qrkey"}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:"Qrkey"===e.activeName,expression:"activeName === 'Qrkey'"}]},[t("el-row",{attrs:{gutter:20,type:"flex",justify:"center"}},[t("canvas",{ref:"MyCanvas"})])],1),t("el-form",{directives:[{name:"show",rawName:"v-show",value:"Qrkey"!==e.activeName,expression:"activeName !== 'Qrkey'"}],ref:"ruleForm",attrs:{model:e.form,rules:e.rules}},[t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"phone"===e.activeName,expression:"activeName === 'phone'"}],attrs:{prop:"phone",label:"手机号"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"email"===e.activeName,expression:"activeName === 'email'"}],attrs:{prop:"email",label:"邮箱帐号"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),t("el-form-item",{attrs:{prop:"password",label:"密码"}},[t("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.login}},[e._v(e._s("Qrkey"===e.activeName?"确定":"登录"))])],1)],1),t("el-popover",{ref:"popoverUser",attrs:{placement:"bottom",width:"200",trigger:"click"}},[t("div",[t("el-row",{attrs:{type:"flex",justify:"center"}},[t("el-button",{attrs:{type:"danger",round:""},on:{click:e.loginOut}},[e._v("退出登录")])],1)],1)])],1)}),k=[],C=(s("d9e2"),s("1925")),x=s("cf7e"),Q=s("d055"),j=s.n(Q),I=s("6821"),N=s.n(I);const O=(e,t,s)=>{/^(0|86|17951)?(13[0-9]|15[012356789]|166|17[3678]|18[0-9]|14[57])[0-9]{8}$/.test(t)?s():s(new Error("手机号码格式错误"))},S=(e,t,s)=>{/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/.test(t)?s():s(new Error("邮箱格式错误"))};var P={data(){return{QrKey:"",QrInfo:"",input:"",searchlist:[],timer:null,hotList:[],visible:!1,dialogFormVisible:!1,form:{phone:"",email:"",password:"",md5_password:""},activeName:"email",rules:{email:[{required:!0,trigger:"blur",validator:S}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"长度在 6 到 20 个字符",trigger:"blur"}]},Qrtimer:null}},watch:{input(e){this.getSearch()},dialogFormVisible(e){e||(clearInterval(this.Qrtimer),this.Qrtimer=null)}},components:{SongItem:x["a"]},methods:{...Object(n["d"])("user",["initUserCookie","initUserInfo","clearUserInfo"]),getSearch(){clearTimeout(this.timer),this.timer=setTimeout(async()=>{var e;if(0===this.input.length)return;const{data:t}=await Object(C["b"])(this.input,5);console.log(t),this.searchlist=(null===(e=t.result)||void 0===e?void 0:e.songs)||[]},500)},async getHotKeys(){const{data:{result:{hots:e}}}=await Object(C["a"])();this.hotList=e},addhot(e){this.input=e},delResult(){this.input="",this.searchlist=[]},async login(){if("phone"===this.activeName){this.form.email=null,this.form.md5_password=N()(encodeURIComponent(this.form.password)),this.form.password=null;const e=await Object(l["f"])(this.form);console.log(e),200===e.status&&(502===e.data.code?this.$message.warning(e.data.msg):(this.$message.success("登录成功"),this.dialogFormVisible=!1,this.initUserCookie(e.data.cookie),this.initUserInfo(e.data.profile)))}if("email"===this.activeName){this.form.phone=null,this.form.md5_password=N()(encodeURIComponent(this.form.password)),this.form.password=null;const e=await Object(l["e"])(this.form);200===e.status&&(502===e.data.code?this.$message.warning(e.data.msg):200===e.data.code&&(this.$message.success("登录成功"),this.initUserCookie(e.data.cookie),this.initUserInfo(e.data.profile),this.dialogFormVisible=!1)),console.log(e)}},handleClick(e){"phone"===e.name?(clearInterval(this.Qrtimer),this.Qrtimer=null,this.rules={phone:[{required:!0,trigger:"blur",validator:O}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"长度在 6 到 20 个字符",trigger:"blur"}]}):"email"===e.name?(clearInterval(this.Qrtimer),this.Qrtimer=null,this.rules={email:[{required:!0,trigger:"blur",validator:S}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"长度在 6 到 20 个字符",trigger:"blur"}]}):"Qrkey"===e.name&&this.getQrKey()},async loginstate(){const e=await Object(l["i"])();console.log(e),200===e.data.data.code&&e.data.data.account&&this.initUserInfo(e.data.data.profile)},async loginSignin(){const e=await Object(l["l"])();console.log(e),200===e.code&&4===e.point&&this.$message.warning("请勿重复签到"),200===e.code&&3===e.point&&this.$message.success("签到成功")},async loginOut(){const e=await Object(l["j"])();console.log(e),200===e.data.code&&(this.clearUserInfo(),this.visible=!1)},async getQrKey(){const e=await Object(l["d"])();200===e.data.data.code&&(this.QrKey=e.data.data.unikey,console.log(this.QrKey)),this.getQrinfo()},async getQrinfo(){if(this.QrKey){const e=await Object(l["g"])(this.QrKey);console.log(e),j.a.toCanvas(this.$refs.MyCanvas,e.data.data.qrurl),this.getQrState()}},getQrState(){console.log("开始轮训",this.Qrtimer),this.Qrtimer||(this.Qrtimer=setInterval(async()=>{const e=await Object(l["a"])(this.QrKey);console.log(e),400===e.data.code&&(this.$message.warning(e.data.message),clearInterval(this.Qrtimer),this.Qrtimer=null),802===e.data.code&&this.$message.success(e.data.message),803===e.data.code&&(this.$message.success(e.data.message),this.dialogFormVisible=!1,clearInterval(this.Qrtimer),this.Qrtimer=null,this.initUserCookie(e.data.cookie),this.loginstate()),800===e.data.code&&(this.$message.warning(e.data.message),this.getQrKey(),clearInterval(this.Qrtimer),this.Qrtimer=null)},2e3))},async getloginRefresh(){const e=await Object(l["h"])();console.log(e)}},computed:{...Object(n["e"])("user",["userInfo"]),...Object(n["c"])("user",["isLogin"])},created(){this.getHotKeys(),this.loginstate()}},U=P,$=(s("f578"),s("fc43"),Object(u["a"])(U,L,k,!1,null,"6def296a",null)),F=$.exports,K=function(){var e=this,t=e._self._c;return t("section",{staticClass:"app-main"},[t("transition",{attrs:{name:"fade-transform",mode:"out-in"}},[t("router-view")],1)],1)},V=[],q={},z=q,R=Object(u["a"])(z,K,V,!1,null,"b34624d0",null),H=R.exports,A={components:{Aside:p,Header:F,AppMain:H,Footer:_}},M=A,T=(s("f188"),Object(u["a"])(M,i,a,!1,null,"4ace57a9",null));t["default"]=T.exports},c32c:function(e,t,s){},cfb3:function(e,t,s){},d533:function(e,t,s){},f188:function(e,t,s){"use strict";s("34e3")},f578:function(e,t,s){"use strict";s("bebc")},fc43:function(e,t,s){"use strict";s("c32c")}}]);
//# sourceMappingURL=chunk-637ab606.6d21e629.js.map